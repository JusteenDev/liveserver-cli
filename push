#!/data/data/com.termux/files/usr/bin/bash

# Ensure the user is in the git repository
if [ ! -d .git ]; then
  echo "This is not a git repository."
  exit 1
fi

# Set the username and personal access token (replace with your token)
GIT_USERNAME="JusteenDev"
GIT_TOKEN="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"

# Define the repository URL (replace with the actual repo)
REPO_URL="https://github.com/JusteenDev/liveserver-cli.git"

# Full URL including token for authentication
REMOTE_URL="https://$GIT_USERNAME:$GIT_TOKEN@$REPO_URL"

# Commit message (automated)
commit_message="Auto commit - $(date)"

# Loop to commit and push every 10 seconds
while true; do
  # Check if there are any changes
  git status --porcelain | grep -q . || { echo "No changes to commit."; sleep 10; continue; }

  # Stage all changes
  git add .

  # Commit the changes
  git commit -m "$commit_message"

  # Set the remote URL with token-based authentication
  git remote set-url origin $REMOTE_URL

  # Push the changes to the remote repository
  git push origin main

  echo "Changes committed and pushed successfully."

  # Wait for 10 seconds before the next push
  sleep 10
done